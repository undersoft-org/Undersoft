@using Undersoft.SDK.Service.Access
@typeparam TModel where TModel : class, IOrigin, IInnerProxy
@typeparam TValidator where TValidator : class, IValidator<IViewData<TModel>>

@implements IDialogContentComponent<IViewData<TModel>>
@implements IView
@inject IMessageService MessageService



<CascadingValue Value="@Content">

    <!-- Header -->
    <GenericFormPanelTabsHeader TModel="TModel" />

    <FluentStack Orientation="Orientation.Vertical" HorizontalAlignment="HorizontalAlignment.Center" VerticalGap="20">

        <FluentPersona Initials="_initials" Image="_image" ImageSize="150px" Style="height:auto;"/>

        <!-- Body -->
        <GenericFormPanelTabsBody TValidator="TValidator" TModel="TModel" Orientation="Orientation.Vertical" />


    </FluentStack>
    <FluentSpacer/>
    <!-- Footer -->
    <GenericFormPanelTabsFooter TModel="TModel" />

</CascadingValue>



@code
{
    [Inject]
    private IAuthorization _authorization { get; set; } = default!;

    private string _initials
    {
        get
        {
            string s = "";
            if (!string.IsNullOrEmpty(_authorization.Credentials.FirstName))
                s += _authorization.Credentials.FirstName.First().ToString();
            if (!string.IsNullOrEmpty(_authorization.Credentials.LastName))
                s += _authorization.Credentials.LastName.First().ToString();
            if (string.IsNullOrEmpty(s))
                s = "?";
            return s;
        }
    }

    private string _image => _authorization.Credentials.Image;

    [Parameter]
    public IViewData<TModel> Content { get; set; } = default!;

    [CascadingParameter]
    public FluentDialog Dialog { get; set; } = default!;

    protected override void OnInitialized()
    {
        base.OnInitialized();
    }

    public void RenderView()
    {
        this.StateHasChanged();
    }

}